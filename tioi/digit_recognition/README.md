
# üéôÔ∏è –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ü–∏—Ñ—Ä –ø–æ –∑–≤—É–∫–æ–≤—ã–º —Ñ–∞–π–ª–∞–º (—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã)

## üì¶ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–Ω–æ—Å–∏–º—ã—Ö —Ü–∏—Ñ—Ä (0, 1, 2) –ø–æ –∑–≤—É–∫–æ–≤—ã–º —Ñ–∞–π–ª–∞–º `.wav`, –ø—Ä–µ–æ–±—Ä–∞–∑—É—è –∏—Ö –≤ —Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã –∏ –æ–±—É—á–∞—è –¥–≤–µ –º–æ–¥–µ–ª–∏:

- üß† **Simple CNN** ‚Äî —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å
- üß† **MobileNetV2** ‚Äî –º–æ—â–Ω–∞—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –∏–∑ Keras

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è, –≤—ã–≤–æ–¥–∏—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫ —Ç–æ—á–Ω–æ—Å—Ç–∏ (`comparison.png`) –∏ –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫ (`confusion_matrix.png`, `confusion_matrix_mobilenet.png`).

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
digit_recognition/
‚îú‚îÄ‚îÄ audio/                         # .wav —Ñ–∞–π–ª—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ spectrogram_dataset/          # –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ train/                    # –°–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ val/                      # –°–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ generate_spectrograms.py      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º –∏–∑ .wav
‚îú‚îÄ‚îÄ split_train_val.py            # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/val
‚îú‚îÄ‚îÄ spectrogram_digit_classifier.py  # –û–±—É—á–µ–Ω–∏–µ 2 –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ predict_one.py                # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ —Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º–µ
‚îú‚îÄ‚îÄ predict_from_wav.py           # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ .wav —Ñ–∞–π–ª—É
‚îú‚îÄ‚îÄ setup_and_run.sh              # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤
‚îú‚îÄ‚îÄ comparison.png                # –ì—Ä–∞—Ñ–∏–∫ —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ confusion_matrix.png          # –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ Simple CNN
‚îú‚îÄ‚îÄ confusion_matrix_mobilenet.png # –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ MobileNetV2
‚îî‚îÄ‚îÄ prediction_preview.png        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ .wav (—Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π)
```

---

## ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–ê–∫—Ç–∏–≤–∏—Ä—É–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:

```bash
python3 -m venv .venv
source .venv/bin/activate
```

–£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install -r requirements.txt
```

---

## üöÄ –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ (–≤—Å—ë —Å—Ä–∞–∑—É)

```bash
bash setup_and_run.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã
- –¥–µ–ª–∏—Ç –Ω–∞ train/val
- –æ–±—É—á–∞–µ—Ç –æ–±–µ –º–æ–¥–µ–ª–∏
- —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç confusion matrix

---

## üìä –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

### üîç –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ–π —Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º–µ `.png`:

```bash
python predict_one.py spectrogram_dataset/val/1/recordings_1_lucas_0.png
```

### üîä –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ –∑–≤—É–∫–æ–≤–æ–º—É —Ñ–∞–π–ª—É `.wav`:

```bash
python predict_from_wav.py audio/0_george_1.wav
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è:
- —Ç–µ–∫—Å—Ç —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º
- —Ñ–∞–π–ª `prediction_preview.png` ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è + —Ç–µ–∫—Å—Ç

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

- `comparison.png` ‚Äî —Ç–æ—á–Ω–æ—Å—Ç—å Simple CNN –∏ MobileNetV2
- `confusion_matrix.png` ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ –¥–ª—è Simple CNN
- `confusion_matrix_mobilenet.png` ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ –¥–ª—è MobileNetV2
- `prediction_preview.png` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –æ–¥–Ω–æ–º—É .wav —Ñ–∞–π–ª—É

---

## üõ†Ô∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

1. –î–æ–±–∞–≤—å `.wav` —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É `audio/`
2. –ü—Ä–æ–ø–∏—à–∏ –Ω—É–∂–Ω—ã–µ –º–µ—Ç–∫–∏ (`labels`) –≤ `generate_spectrograms.py`
3. –ó–∞–ø—É—Å—Ç–∏:

```bash
python generate_spectrograms.py
python split_train_val.py
python spectrogram_digit_classifier.py
```

–ò–ª–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
```bash
bash setup_and_run.sh
```

---

## üìé –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- TensorFlow 2.x
- scikit-learn
- matplotlib
- scipy

---



