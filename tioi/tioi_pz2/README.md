
---

# Описание проекта: Классификация цифр на чётные и нечётные

## Назначение

Программа обучает модель (нейросеть или логистическую регрессию) на базе MNIST-датасета для определения чётности цифр. Поддерживаются однозначные и двухзначные изображения. Программа может использовать готовую модель для распознавания изображения с файла или нарисованной мышкой цифры.

## Возможности

* Обучение моделей классификации (нейросеть / логистическая регрессия)
* Распознавание загруженных изображений
* Рисование цифры мышкой и её анализ
* Работа с однозначными и составными цифрами (две склеенные цифры)
* Сохранение результатов (графики, матрицы ошибок)
* Визуализация метрик точности через MLflow

---

## Основные команды

### 1. Обучение модели с нуля

```bash
python main.py --model nn --epochs 30 --lr 0.8 --batch 256 --save weights/model_nn.npz
```

Если нужна логистическая регрессия:

```bash
python main.py --model logreg --epochs 20 --lr 0.2 --batch 128 --save weights/model_logreg.npz
```

### 2. Загрузка модели и распознавание изображения

```bash
python main.py --model nn --load weights/model_nn.npz --img путь/к/файлу.png
```

### 3. Нарисовать цифру и распознать

```bash
python main.py --model nn --load weights/model_nn.npz --draw
```

### 4. Работа с двухзначными цифрами

```bash
python main.py --model nn --compose --epochs 30 --save weights/model_composed.npz
```

---

## Логирование и визуализация (MLflow)

Для запуска визуализации обучения:

```bash
mlflow ui
```

Затем открыть браузер: [http://127.0.0.1:5000](http://127.0.0.1:5000)
Там отображаются:

* Точность на обучающей и тестовой выборке
* Выбранные параметры модели (кол-во эпох, learning rate и т.д.)
* Сравнение между несколькими запусками

---

## Выходные файлы

* `sample_predictions.png` — примеры предсказаний с визуализацией
* `confusion_matrix.png` — 2×2 матрица ошибок: предсказанная и реальная чётность
* `confusion_matrix_2x10.png` — расширенная матрица ошибок по последним цифрам (для двухзначных)

---

## Установка зависимостей

```bash
pip install numpy matplotlib seaborn scikit-learn mlflow opencv-python
```

---

